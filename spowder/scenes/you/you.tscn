[gd_scene load_steps=16 format=3 uid="uid://cx1g3fipburm0"]

[ext_resource type="Script" uid="uid://bdnjgdue6t5iy" path="res://addons/snotbane/modules/debug/draw/DebugDraw3D_Shape.gd" id="1_f8i81"]
[ext_resource type="Script" uid="uid://cfnfv1yn5habd" path="res://spowder/scenes/you/InputTurn.gd" id="1_hkixc"]
[ext_resource type="Script" uid="uid://dlf62fdavp7e1" path="res://spowder/scripts/Pawn.gd" id="1_lxb7o"]
[ext_resource type="PackedScene" uid="uid://b7mr0xn6bkp" path="res://spowder/scenes/weapon/shotgun.tscn" id="3_6ftwj"]
[ext_resource type="PackedScene" uid="uid://ds37tl2me0mvh" path="res://spowder/scenes/you/rear_view_mirror.tscn" id="5_dylk3"]
[ext_resource type="Script" uid="uid://b13ni8oa6sr6d" path="res://spowder/scenes/you/InputShoot.gd" id="6_4j7o2"]
[ext_resource type="Script" uid="uid://clpoav1o8o1vo" path="res://spowder/scenes/you/Ammo.gd" id="6_6ftwj"]
[ext_resource type="Script" uid="uid://dhnth3qx8cupt" path="res://spowder/scenes/you/InputBrake.gd" id="6_dylk3"]
[ext_resource type="Theme" uid="uid://02b87o8f1c0l" path="res://default.tres" id="8_2x3ne"]
[ext_resource type="Script" path="res://spowder/scenes/you/InputReset.gd" id="8_ngbxx"]
[ext_resource type="Script" uid="uid://cg7rqcilp6dkr" path="res://spowder/scripts/Message.gd" id="12_s2eyp"]
[ext_resource type="Script" uid="uid://btwbp8ygwn64c" path="res://spowder/scenes/menu/PauseController.gd" id="12_ym75q"]

[sub_resource type="CapsuleShape3D" id="CapsuleShape3D_ehk27"]
radius = 0.8

[sub_resource type="StyleBoxEmpty" id="StyleBoxEmpty_ym75q"]

[sub_resource type="CylinderMesh" id="CylinderMesh_ym75q"]
top_radius = 1.25
bottom_radius = 0.0
height = 0.1
cap_bottom = false

[node name="you" type="CharacterBody3D" groups=["player"]]
floor_max_angle = 1.5707964
script = ExtResource("1_lxb7o")
bounce_factor = Vector2(1, 1)

[node name="shape" type="CollisionShape3D" parent="."]
shape = SubResource("CapsuleShape3D_ehk27")

[node name="debug_draw_3d_shape" type="Node3D" parent="shape"]
script = ExtResource("1_f8i81")
color = Color(0, 0.36862746, 1, 0.39215687)
debug_visibility = 1
metadata/_custom_type_script = "uid://bdnjgdue6t5iy"

[node name="head" type="Node3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.667, 0)

[node name="camera" type="Camera3D" parent="head"]
cull_mask = 1048573
current = true
fov = 90.0

[node name="weapon_socket" type="Node3D" parent="head" node_paths=PackedStringArray("ammo")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0.5327107, -0.48869917, -0.401)
script = ExtResource("6_4j7o2")
ammo = NodePath("../../hud_canvas/hud/ammo_offset/ammo")

[node name="shotgun" parent="head/weapon_socket" instance=ExtResource("3_6ftwj")]
recoil_impulse_power = Vector2(16, 12)

[node name="mirror" parent="head" instance=ExtResource("5_dylk3")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -0.6466253, -0.11925948, -0.83808327)
visible = false

[node name="input_turn" type="Node" parent="." node_paths=PackedStringArray("affector_yaw", "affector_pitch")]
script = ExtResource("1_hkixc")
affector_yaw = NodePath("..")
affector_pitch = NodePath("../head")
turn_speed_mouse = Vector2(0.2, 0.2)
turn_speed_other = Vector2(2, 2)

[node name="input_brake" type="Node" parent="."]
script = ExtResource("6_dylk3")
damping = 0.05
enabled = false

[node name="input_reset" type="Timer" parent="."]
wait_time = 1.5
script = ExtResource("8_ngbxx")

[node name="hud_canvas" type="CanvasLayer" parent="."]

[node name="hud" type="Control" parent="hud_canvas"]
texture_filter = 1
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
mouse_filter = 2
theme = ExtResource("8_2x3ne")

[node name="ammo_offset" type="Control" parent="hud_canvas/hud"]
layout_mode = 1
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
grow_horizontal = 2
grow_vertical = 2

[node name="ammo" type="HBoxContainer" parent="hud_canvas/hud/ammo_offset"]
layout_mode = 1
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
grow_horizontal = 2
grow_vertical = 2
alignment = 1
script = ExtResource("6_6ftwj")
shell_uid = "uid://ddn3c02gerhnp"
shell_count = 2
ignore_time = 0.01

[node name="menu_canvas" type="CanvasLayer" parent="."]
layer = 10

[node name="menu" type="Control" parent="menu_canvas"]
process_mode = 2
visible = false
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("8_2x3ne")

[node name="background" type="ColorRect" parent="menu_canvas/menu"]
layout_mode = 1
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
color = Color(0, 0, 0, 0.19607843)

[node name="pause_controller" type="Node" parent="menu_canvas/menu"]
process_mode = 3
script = ExtResource("12_ym75q")
exit_scene = "uid://cmb0oadsxhycs"

[node name="v_box_container" type="VBoxContainer" parent="menu_canvas/menu"]
layout_mode = 1
anchors_preset = 14
anchor_top = 0.5
anchor_right = 1.0
anchor_bottom = 0.5
offset_top = -10.0
offset_bottom = 10.0
grow_horizontal = 2
grow_vertical = 2

[node name="rich_text_label" type="RichTextLabel" parent="menu_canvas/menu/v_box_container"]
texture_filter = 1
layout_mode = 2
bbcode_enabled = true
text = "[shake level=11 rate=40 connected=false]paused"
fit_content = true
horizontal_alignment = 1

[node name="resume" type="Button" parent="menu_canvas/menu/v_box_container"]
custom_minimum_size = Vector2(132.08, 24)
layout_mode = 2
size_flags_horizontal = 4
theme_override_styles/focus = SubResource("StyleBoxEmpty_ym75q")
script = ExtResource("12_s2eyp")
bbcode = "[shake level=11 rate=40 connected=0]"
message = "resumE"
label_visible = true

[node name="exit" type="Button" parent="menu_canvas/menu/v_box_container"]
custom_minimum_size = Vector2(132.08, 24)
layout_mode = 2
size_flags_horizontal = 4
theme_override_styles/focus = SubResource("StyleBoxEmpty_ym75q")
script = ExtResource("12_s2eyp")
bbcode = "[shake level=11 rate=40 connected=0]"
message = "exit"
label_visible = true

[node name="shadow" type="MeshInstance3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, -0.5, 0)
cast_shadow = 3
mesh = SubResource("CylinderMesh_ym75q")

[connection signal="slide_collided" from="." to="hud_canvas/hud/ammo_offset/ammo" method="_on_character_collided"]
[connection signal="fired" from="head/weapon_socket/shotgun" to="." method="spowder_launch"]
[connection signal="reloaded" from="hud_canvas/hud/ammo_offset/ammo" to="head/weapon_socket/shotgun/bullet_spawn_location/reload_audio" method="play"]
[connection signal="pressed" from="menu_canvas/menu/v_box_container/resume" to="menu_canvas/menu/pause_controller" method="set_paused" binds= [false]]
[connection signal="pressed" from="menu_canvas/menu/v_box_container/exit" to="menu_canvas/menu/pause_controller" method="exit_to_menu"]

[editable path="head/weapon_socket/shotgun"]
